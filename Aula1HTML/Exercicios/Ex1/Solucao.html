<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Painel 2x2</title>
  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --text:#222;
      --accent:#4f46e5;
      --muted:#6b7280;
    }
    .dark{
      --bg:#0b1220;
      --card:#0f1724;
      --text:#e6eef8;
      --accent:#7c3aed;
      --muted:#9aa6b2;
    }

    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg); color:var(--text); min-height:100vh; display:flex; align-items:center; justify-content:center;
      padding:20px;
    }

    .grid{
      width:100%; max-width:1100px; display:grid; grid-template-columns:1fr 1fr; grid-template-rows:1fr 1fr; gap:20px;
    }

    .card{
      background:var(--card); border-radius:12px; padding:18px; box-shadow:0 6px 18px rgba(8,10,15,0.06);
      display:flex; flex-direction:column; gap:12px;
    }

    /* Calculadora */
    .calc{max-width:420px;margin:auto}
    .display{background:transparent;border-radius:8px;padding:12px 16px;font-size:28px;text-align:right;border:1px solid rgba(0,0,0,0.06);min-height:56px}
    .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:12px}
    button.key{padding:14px;border-radius:8px;border:0;font-size:18px;cursor:pointer;background:linear-gradient(180deg,rgba(0,0,0,0.03),transparent);}
    button.op{background:var(--accent);color:white}
    button.wide{grid-column:span 2}

    /* Relógio */
    .clock{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}
    .time{font-size:42px;font-weight:700}
    .date{color:var(--muted)}

    /* Checklist */
    .checklist ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px}
    .task{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px}
    .task input[type="checkbox"]{width:18px;height:18px}
    .task label{font-size:16px}

    /* Tema */
    .theme{display:flex;flex-direction:column;gap:8px}
    .radios{display:flex;gap:12px}

    /* Responsivo */
    @media (max-width:800px){
      .grid{grid-template-columns:1fr;grid-template-rows:repeat(4,auto)}
    }

  </style>
</head>
<body>
  <div class="grid" id="app">
    <!-- Top-left: Calculadora -->
    <div class="card" id="calcCard">
      <h3>Calculadora</h3>
      <div class="calc">
        <div id="display" class="display" aria-live="polite">0</div>
        <div class="keys">
          <button class="key" data-val="7">7</button>
          <button class="key" data-val="8">8</button>
          <button class="key" data-val="9">9</button>
          <button class="key op" data-val="/">÷</button>

          <button class="key" data-val="4">4</button>
          <button class="key" data-val="5">5</button>
          <button class="key" data-val="6">6</button>
          <button class="key op" data-val="*">×</button>

          <button class="key" data-val="1">1</button>
          <button class="key" data-val="2">2</button>
          <button class="key" data-val="3">3</button>
          <button class="key op" data-val="-">−</button>

          <button class="key" data-val="0">0</button>
          <button class="key" data-val=".">.</button>
          <button class="key wide" id="equals">=</button>
          <button class="key op" data-val="+">+</button>

          <button class="key" id="clear">C</button>
          <button class="key" id="del">⌫</button>
        </div>
      </div>
    </div>

    <!-- Top-right: Relógio digital -->
    <div class="card clock" id="clockCard">
      <div class="time" id="time">--:--:--</div>
      <div class="date" id="date">--</div>
    </div>

    <!-- Bottom-left: Checklist -->
    <div class="card checklist" id="checkCard">
      <h3>Checklist do dia</h3>
      <ul>
        <li class="task"><input type="checkbox" id="t1"><label for="t1">Beber 2 litros de água</label></li>
        <li class="task"><input type="checkbox" id="t2"><label for="t2">Correr</label></li>
        <li class="task"><input type="checkbox" id="t3"><label for="t3">Estudar inglês</label></li>
        <li class="task"><input type="checkbox" id="t4"><label for="t4">Cuidar do jardim</label></li>
      </ul>
      <div style="margin-top:auto;display:flex;gap:8px;align-items:center">
        <button id="resetTasks" style="padding:8px 12px;border-radius:8px;border:0;cursor:pointer">Limpar</button>
        <small style="color:var(--muted)">O estado é salvo no navegador.</small>
      </div>
    </div>

    <!-- Bottom-right: Radio tema -->
    <div class="card theme" id="themeCard">
      <h3>Tema</h3>
      <div class="radios">
        <label><input type="radio" name="theme" value="light"> Claro</label>
        <label><input type="radio" name="theme" value="dark"> Escuro</label>
      </div>
      <p style="color:var(--muted)">Escolha entre tema claro e escuro; preferência salva no navegador.</p>
    </div>
  </div>

  <script>
    // ---------- Tema ----------
    const root = document.documentElement;
    const body = document.body;
    const themeRadios = document.querySelectorAll('input[name="theme"]');
    function applyTheme(t){
      if(t==='dark'){ body.classList.add('dark'); } else { body.classList.remove('dark'); }
      localStorage.setItem('panel-theme', t);
      // set radio states
      themeRadios.forEach(r=>r.checked = (r.value===t));
    }
    // init
    const savedTheme = localStorage.getItem('panel-theme')||'light';
    applyTheme(savedTheme);
    themeRadios.forEach(r=>r.addEventListener('change',e=>applyTheme(e.target.value)));

    // ---------- Relógio ----------
    const timeEl = document.getElementById('time');
    const dateEl = document.getElementById('date');
    function updateClock(){
      const now = new Date();
      const hh = String(now.getHours()).padStart(2,'0');
      const mm = String(now.getMinutes()).padStart(2,'0');
      const ss = String(now.getSeconds()).padStart(2,'0');
      timeEl.textContent = `${hh}:${mm}:${ss}`;
      dateEl.textContent = now.toLocaleDateString();
    }
    updateClock();
    setInterval(updateClock,1000);

    // ---------- Calculadora ----------
    const display = document.getElementById('display');
    let expression = '';
    function refreshDisplay(){ display.textContent = expression || '0'; }

    function safeEval(expr){
      // Bloqueia caracteres não permitidos: aceita dígitos, . e +-*/()
      if(!/^[0-9+\-*/().\s]+$/.test(expr)) return 'Erro';
      try{ // eslint-disable-next-line no-eval
        const val = Function('return '+expr)();
        if(val===undefined) return 'Erro';
        return String(val);
      }catch(e){return 'Erro'}
    }

    document.querySelectorAll('.key').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const v = btn.dataset.val;
        if(v){ expression += v; refreshDisplay(); }
      })
    });
    document.getElementById('clear').addEventListener('click',()=>{ expression=''; refreshDisplay(); });
    document.getElementById('del').addEventListener('click',()=>{ expression = expression.slice(0,-1); refreshDisplay(); });
    document.getElementById('equals').addEventListener('click',()=>{
      const res = safeEval(expression);
      expression = (res==='Erro')? '': res;
      refreshDisplay();
    });

    // permitir enter e teclas
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){ e.preventDefault(); const res = safeEval(expression); expression = (res==='Erro')? '': res; refreshDisplay(); }
      else if(e.key === 'Backspace'){ expression = expression.slice(0,-1); refreshDisplay(); }
      else if(/^[0-9+\-*/().]$/.test(e.key)){ expression += e.key; refreshDisplay(); }
    });

    // ---------- Checklist (salvar no localStorage) ----------
    const taskIds = ['t1','t2','t3','t4'];
    function loadTasks(){
      taskIds.forEach(id=>{
        const el = document.getElementById(id);
        const saved = localStorage.getItem('task-'+id);
        el.checked = saved==='1';
        el.addEventListener('change', ()=>{ localStorage.setItem('task-'+id, el.checked? '1':'0'); });
      });
    }
    document.getElementById('resetTasks').addEventListener('click',()=>{
      taskIds.forEach(id=>{ document.getElementById(id).checked=false; localStorage.removeItem('task-'+id); });
    });
    loadTasks();

  </script>
</body>
</html>
